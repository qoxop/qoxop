<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="author" content="qoxop">
    <meta name="keywords" content="">
    <meta name="description" content="程序员总是喜欢省事，相同的东西要写到一起，不同的东西才分别写，这可能就是老生常谈的‘复用’吧，曾经看到过这样的一段代码, 它实现了这种所谓‘复用’的效果：">
    <link rel="stylesheet" href="/assets/style/index.css">
    <title>会变的东西不要写到模块变量中</title>
<link rel="stylesheet" href="/assets/code_styles/solarized-light.css"></head>
<body>
    <header>
        <div class="header">
            <h1>阿伟的网络日志</h1>
            <nav>
                <ul>
                    <li>
                        <a class="unset" href="/index.html">Home</a>
                    </li>
                    <li>
                        <a class="unset" href="/tags.html">Tags</a>
                    </li>
                    <li>
                        <a class="unset" href="/about.html">About</a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>
    <main>
        <article id="article_main"><h1>会变的东西不要写到模块变量中</h1><section class="article_info">
        <span class="author">author: qoxop</span>
        <span class="update_time">updateAt: 2019-03-06</span>
    </section><div class="from_markdown"><p>程序员总是喜欢省事，相同的东西要写到一起，不同的东西才分别写，这可能就是老生常谈的‘复用’吧，曾经看到过这样的一段代码, 它实现了这种所谓‘复用’的效果：</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> apiGet = ({url, params}) = <span class="hljs-built_in">require</span>.get(url, {
    <span class="hljs-attr">params</span>: {
        <span class="hljs-attr">projId</span>: getProjIdFromUrl(),
        ...params
    }
})
<span class="hljs-string">``</span><span class="hljs-string">`

一开始看好像没啥毛病，它目的是将`</span>projId<span class="hljs-string">`这个参数封装起来，免得每次调用接口时都去传入这样的一个参数，但是问题在于`</span>apiGet<span class="hljs-string">`是定义在了模块变量上的，对于单页面引用而言，路由参数的变化并不会导致页面的完全刷新，在切换项目之后，会出现接口的`</span>projId<span class="hljs-string">`对应不上的问题。

出现这种问题的主要原因还是对ES6模块化的理解不够深刻导致的。</span></code></pre>
</div><section class="tags_bar"></section></article>
        <aside> 
            <section class="assist-tool">
                <div class="back-to-top">
                    <em class="iconfont icon-top"></em>
                </div>
            </section>
        </aside>
    </main>
    <footer>
        <div class="scrollTips" id="scrollTips">
        </div>
        <section class="copyright">
            copyright © 2019 by zhangjiwei
        </section>
        <section class="ICP_NUM">
            <a href="http://www.miitbeian.gov.cn">
                粤ICP备19026817号-1
            </a>
        </section>
    </footer>
    <script src="/assets/script/common.js"></script>


<script src="/assets/script/article.js"></script></body></html>